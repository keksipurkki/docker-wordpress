# Requires docker-compose >= 1.5.2

wordpress:
  build: .
  ports:
    - 443:443
    - 80:80
  volumes:
    - ../wp-config.php:/home/wordpress/public_html/wp-config.php
    - ../debug.log:/home/wordpress/public_html/wp-content/debug.log
    - ../wp-content:/home/wordpress/public_html/wp-content

logging:
  image: php:5.6-apache
  volumes:
    - ./php.ini:/usr/local/etc/php/php.ini
    - ./config.user.php:/var/www/html/logging/config.user.php
    - ../vendor/potsky/pimp-my-log:/var/www/html/logging
    - ../debug.log:/var/log/debug.log:ro
  ports:
    - 8080:80
  command: bash -c 'php -S 0.0.0.0:80 -t /var/www/html/logging > /dev/null 2>&1' 

db:
  image: mysql:5.7
  environment:
    MYSQL_USER: docker
    MYSQL_ROOT_PASSWORD: dummy
    MYSQL_PASSWORD: dummy
    MYSQL_DATABASE: dummy
  ports:
    - 8889:3306

# Here's where you step in...

# Define one of these for each WordPress installation you develop. Remember to
# define the host (WP_LOCAL_DOMAIN) in /etc/hosts, i.e., map 127.0.0.1 (Linux)
# or the IP address of the docker-machine (Win, Mac OSX) to your development
# domains so that you can access the sites from your browser. If you're on Mac
# OSX, give Gas Mask (https://github.com/2ndalpha/gasmask) a try.
mytheme:
  extends: wordpress
  links:
    - db:mysql
  environment:
    WP_LOCAL_DOMAIN: mytheme.dev
    WP_ASSETS_DOMAIN: some.domain.com
